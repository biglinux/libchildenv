# Maintainer: Bruno Goncalves <bigbruno@gmail.com>
# Contributor: Leandro Guedes <leanguedes at icloud dot com>

pkgname=libchildenv
pkgver=1.0
pkgrel=1
arch=('x86_64')
license=('GPL-3.0-or-later')
url="https://github.com/biglinux/libchildenv"
pkgdesc="Modifying environment variables received by child processes"
depends=(
    'bash'
    'glibc'
)
makedepends=(
    'gcc'
    'git'
)
optdepends=(
    'gperftools: tcmalloc support'
    'jemalloc: jemalloc support'
    'mimalloc: mimalloc support'
)
source=("git+https://github.com/biglinux/libchildenv.git")
md5sums=('SKIP')

build() {
    cd "$srcdir/$pkgname"
    gcc -shared -fPIC -o libchildenv.so libchildenv.c -ldl
}

package() {
    install -Dm755 $srcdir/libchildenv/libchildenv.so "${pkgdir}/usr/lib/libchildenv.so"
    install -Dm755 $srcdir/libchildenv/libchildenv.sh "${pkgdir}/usr/bin/libchildenv.sh"
}
